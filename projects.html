<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="description" content="personal site">
	<meta name="author" content="Sam Lau">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sam Lau</title>
	<link href="images/faviconTemp.jpg" rel="icon">
	<link media="screen and (min-width: 901px)" href="main.css" rel="stylesheet">
    <link media="screen and (max-width: 900px)" href="main-mobile.css" rel="stylesheet">
</head>

<body>
	<header>
        <nav>
            <a href="index.html">About</a>
            <a href="projects.html">Projects</a>
            <a href="contact.html">Contact</a>
            <a href="experiement.html">Labs</a>
            <button id="mode" hidden>light</button>
        </nav>
        <h1 class="proj-header">Projects</h1>
	</header>

	<main class="project">
        <section class="proj-section" id="project1">
            <hgroup>
                <h2>Calendar App</h2>
                <p>My role on the team involved implemenenting all the calendar logic, and functionality. Additionally, I worked on the design work and testing for the site.</p>
                <a href="https://github.com/cse110-sp24-group16/cse110-sp24-group16">Github</a>
            </hgroup>
            <img class="preview" src="images/prev1.png" height="250" alt="calandar app preview">
        </section>

        <header>
            <h1 class="proj-header">Digital Art</h1>
        </header>
        
        <div id="gallery">
            
        </div>

	</main>
    <script src="main-script.js"></script>
    <script>
        class ArtCard extends HTMLElement {
            constructor() {
                super();
            }
            connectedCallback() {
                const aName = this.getAttribute('aName') || 'Unknown Name';
                const link = this.getAttribute('link') || 'Unknown Link';
                const desc = this.getAttribute('desc') || 'Unknown Description';
                const srcUrl = this.getAttribute('scrUrl') || 'Unknown Source';
                const imgUrl = this.getAttribute('imgUrl') || 'Unknown Image';
                this.componentHeader = document.createElement('h2');
                this.componentHeader.textContent = aName;
                this.appendChild(this.componentHeader);

                this.picture = document.createElement('picture');
                this.source = document.createElement('source');
                this.source.setAttribute('class', 'imgdes');
                this.source.setAttribute('media', '(min-width: 1500px)');
                this.source.setAttribute('srcset', srcUrl);
                this.imgDef = document.createElement('img');
                this.imgDef.setAttribute('class', 'imgmob');
                this.imgDef.setAttribute('src', imgUrl);

                this.picture.appendChild(this.source);
                this.picture.appendChild(this.imgDef);
                this.appendChild(this.picture);

                this.linkedCon = document.createElement('a');
                this.linkedCon.setAttribute('class', 'artLink');
                this.linkedCon.setAttribute('href', link);
                this.linkedCon.textContent = desc;
                this.appendChild(this.linkedCon);
            }
        }
        customElements.define('art-card', ArtCard);

        window.addEventListener('DOMContentLoaded', async () => {
            console.log("DOM Content loaded");
            const url = "https://api.jsonbin.io/v3/b/67d4e1898561e97a50ec368d";
            try {
                const response = await fetch(url, {
                    method: "GET",
                    headers: {
                        "X-Access-Key": "$2a$10$pevFeZOq1hJGsp9.cwKQh.V/RNsamY1v0mJB6JYNY5ppymuPrH7C2",
                    }
                });
                if (!response.ok) {
                    throw new Error(`Response status: ${response.status}`);
                }

                const jsonData = await response.json();
                jsonData.record.forEach(work => {
                    console.log(work.name);
  
                    window.galleryItem = document.createElement("art-card");
                    window.galleryItem.setAttribute('aName', work.name);
                    window.galleryItem.setAttribute('link', work.linked_con);
                    window.galleryItem.setAttribute('desc', work.description);
                    window.galleryItem.setAttribute('srcUrl', work.source_url);
                    window.galleryItem.setAttribute('imgUrl', work.img_url);
                    document.getElementById("gallery").appendChild(window.galleryItem);
                });

            } catch (error) {
                console.error(error.message);
            }
        });

    </script>
</body>

</html>